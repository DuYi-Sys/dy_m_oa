<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"><HTML>
<HEAD><TITLE>ActiveXObject 对象</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css">
<META NAME="MS-HKWD" CONTENT="ActiveXobject 对象">
<META NAME="MS-HKWD" CONTENT="ActiveXobject">
<META NAME="MS-HKWD" CONTENT="对象变量">
<META NAME="MS-HKWD" CONTENT="创建对象">
<META NAME="MS-HKWD" CONTENT="创建 Automation 对象">
<META NAME="MS-HKWD" CONTENT="变量">
<META NAME="MS-HKWD" CONTENT="Automation 对象">
<META NAME="MS-HKWD" CONTENT="DCOM">
<META NAME="MS-HKWD" CONTENT="远程服务器示例">                                           

<META NAME=MS-HAID CONTENT="jsobjActiveXObject"> 
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
<META NAME="MS.LOCALE" CONTENT="ZH-CN">
<META NAME="PRODUCT" CONTENT="JScript">
<META NAME="TECHNOLOGY" CONTENT="SCRIPTING">
<META NAME="CATEGORY" CONTENT="Language Reference">
<META NAME="Description" CONTENT="ActiveXObject Object">
<META NAME="Keywords" CONTENT="ActiveXObject object; ActiveXObject; object variable; creating objects; creating Automation objects; variables; Automation objects; DCOM; remote server instantiation">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LINK="#0033CC">

<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
<FONT FACE=" 宋体"  class='9v'>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=100%><TR VALIGN=TOP><TD WIDTH=380>
<FONT class='9v' COLOR="#660033">Microsoft(R) JScript(R)</FONT>&nbsp;<BR>
<FONT SIZE=5 COLOR="#660033"><B>
ActiveXObject 对象</B></FONT>

</TD>
<TD ALIGN=RIGHT>
<FONT class='9v' >&nbsp;<a href="jstoc.htm">语言参考</A>&nbsp;<BR>
<a href="jsversion.htm">版本&nbsp;3</A>&nbsp;<P></FONT>
</TD></TR>
</TABLE> 
<FONT class='9v' ><P>
<a href="jsobjActiveXObjectC.htm">请参阅</A></FONT>
<HR noshade class='9v' >

<H5>描述</H5>
<BLOCKQUOTE>启用并返回 <a href="glossary.htm#defAutomationObject">Automation 对象</a>的引用。</BLOCKQUOTE>

<H5>语法</H5>
<BLOCKQUOTE>var newObject = new <b>ActiveXObject(</b>"<i>servername.typename</i>"[<b>,</b> "location"])</b><P>
<B>ActiveXObject</B> 对象语法有这些部分：<P>

<TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>

<TR VALIGN=TOP BGCOLOR="#DDDDDD">
	<TD><FONT class='9v' ><b>部分</b></FONT></TD>
		<TD><FONT class='9v' ><b>描述</b></FONT></TD></TR>

<TR VALIGN=TOP>
	<TD><FONT class='9v' ><i>servername</i></FONT></TD>
		<TD><FONT class='9v' >必选项。提供该对象的应用程序的名称。</FONT></TD></TR>

<TR VALIGN=TOP>
	<TD><FONT class='9v' ><i>typename</i></FONT></TD><TD><FONT class='9v' >必选项。要创建的对象的类型或类。</FONT></TD></TR>

<TR VALIGN=TOP>
	<TD><FONT class='9v' ><i>location</i></FONT></TD><TD><FONT class='9v' >可选项。创建该对象的网络服务器的名称。</FONT></TD></TR>
</TABLE></BLOCKQUOTE>

<H5>说明</H5>
<BLOCKQUOTE>Automation 服务器至少提供一类对象。例如，字处理应用程序可能提供应用程序对象、文档对象和工具栏对象。<P>

要创建 Automation 对象，将新的 <b>ActiveXObject</b> 赋给对象变量：
<BLOCKQUOTE><PRE><FONT face=" 宋体" class='9v' >var ExcelSheet;
ExcelSheet = new <FONT COLOR="#FF0000">ActiveXObject(</FONT>"Excel<FONT COLOR="#FF0000">.</FONT>Sheet"<FONT COLOR="#FF0000">)</FONT>;
</FONT></PRE></BLOCKQUOTE>

本代码启动创建对象的应用程序（在这种情况下，Microsoft Excel 工作表）。一旦对象被创建，就可以用定义的对象变量在代码中引用它。 在下面的例子中，通过对象变量 <FONT face=" 宋体" class='9v' >ExcelSheet</FONT> 访问新对象的属性和方法和其他 Excel 对象，包括 Application 对象和 ActiveSheet.Cells 集合。例如：
<BLOCKQUOTE><PRE><FONT face=" 宋体" class='9v' >
// 使 Excel 通过 Application 对象可见。
ExcelSheet.Application.Visible = true;	
// 将一些文本放置到表格的第一格中。
ExcelSheet.ActiveSheet.Cells(1,1).Value = "This is column A, row 1";	
// 保存表格。
ExcelSheet.SaveAs("C:\\TEST.XLS");	
// 用 Application 对象用 Quit 方法关闭 Excel。
ExcelSheet.Application.Quit();	
// 释放对象变量。
ExcelSheet = "";									
</FONT></PRE></BLOCKQUOTE>

只有当 Internet 安全性关闭时才能完成在远程服务器中创建对象。要在远程网络计算机创建对象，可以将该计算机的名称传递给 <B>ActiveXObject</B> 的 <i>servername</i> 参数。该名称与共享名的机器名部分相同。比如共享名为 "\\myserver\public" 的网络，<i>servername</i> 是 "myserver"。另外，可以用 DNS 格式或 IP 地址指定 <i>servername</i>。<P>

下面的代码返回在名为 "myserver" 的远程网络计算机上运行的 Excel 实例的版本号：<P>

<BLOCKQUOTE><PRE><FONT face=" 宋体" class='9v' >Function GetVersion {
  var XLApp = CreateObject("Excel.Application", "MyServer");
  return(XLApp.Version);
}
</FONT></PRE></BLOCKQUOTE>

如果指定的远程服务器不存在或找不到时将发生错误。
</BLOCKQUOTE>

<hr noshade class='9v' >
 

</FONT>
</BODY>
</HTML>


















